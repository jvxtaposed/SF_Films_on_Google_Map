<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
    <style type="text/css">
      html { height: 100% }
      body { height: 100%; }
      #map-canvas { height: 100% }

      .controls {
        margin-top: 16px;
        border: 1px solid transparent;
        border-radius: 2px 0 0 2px;
        box-sizing: border-box;
        -moz-box-sizing: border-box;
        height: 32px;
        outline: none;
        box-shadow: 0 2px 6px rgba(0, 0, 0, 0.3);
      }

      #pac-input {
        background-color: #fff;
        padding: 0 11px 0 13px;
        width: 400px;
        font-family: Roboto;
        font-size: 15px;
        font-weight: 300;
        text-overflow: ellipsis;
      }

      #pac-input:focus {
        border-color: #4d90fe;
        margin-left: -1px;
        padding-left: 14px;
        width: 401px;
      }
    </style>
    <script type="text/javascript"
      src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDf-wnpNYEjM5qHyyY-DtBxr0pSnK94pOo&sensor=true&libraries=places">
    </script>
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
    <script type="text/javascript">
      function initialize() {
         // Center the map.
          var myLatlng = new google.maps.LatLng(37.7583, -122.4275);
          var mapOptions = {
              center: myLatlng,
          };
          // Select the map id canvas.
          var map = new google.maps.Map(document.getElementById("map-canvas"),
              mapOptions);
          // Create boundaries for the map.
          var defaultBounds = new google.maps.LatLngBounds(
              new google.maps.LatLng(37.73, -122.45),
              new google.maps.LatLng(37.82, -122.40));
          map.fitBounds(defaultBounds);

          // Place ALL the film locations on the Google Map using the map markers. Each marker has a pop-up info
          // window containing info about the movie title, filming location, fun facts, and actors.
          // Create a marker for each place.
          {% for title,all_locations in all_data.iteritems() %}
              {% for location_text, lat, longitude, fun_facts in all_locations %}
              // {{ location_text }}, Coordinates: {{ lat }}, {{ longitude }}, {{ fun_facts }}
                  var coordPosition = new google.maps.LatLng({{ lat }}, {{ longitude }});
                  var marker = new google.maps.Marker({
                      map: map,
                      title: "{{ location_text }}",
                      position: coordPosition
                  });
                  var infowindow = new google.maps.InfoWindow({
                  });

                  var movieTitle = "{{ title }}";
                  var locationText = "{{ location_text }}";
                  var funFactsText = "{{ fun_facts }}";
                  var content = "<div class='content'><h4 class='movieTitle'>"+movieTitle +"</h4><div class='bodyContent'><p class='location'><b>Location:</b><br>" + locationText + "</p><p class='fun_facts'>" + "<b>Fun Facts:</b><br>" + funFactsText + "</p></div>";
                 // Create a pop-up window on click.
                  google.maps.event.addListener(marker,'click', (function(marker,content,infowindow){
                      return function() {
                          infowindow.setContent(content);
                          infowindow.open(map,marker);
                      };
                  })(marker,content,infowindow));
               {% endfor %}
             {% endfor %}

/*
           // Create autocompletion search box.
           var input = (document.getElementById('pac-input'));
           map.controls[google.maps.ControlPosition.TOP_LEFT].push(input);
           var searchBox = new google.maps.places.SearchBox((input));
           // Listen for the event fired when the user selects an item from the
           // pick list. Retrieve the matching places for that item.
           google.maps.event.addListener(searchBox, 'places_changed', function() {
               var places = searchBox.getPlaces();
              // For each place, get the icon, place name, and location.
              var bounds = new google.maps.LatLngBounds();
              for (var i = 0, place; place = places[i]; i++) {
                  // Create the icon image associated with the place result. Otherwise, the default is a red point icon.
                  var image = {
                      url: place.icon,
                      size: new google.maps.Size(71, 71),
                      origin: new google.maps.Point(0, 0),
                      anchor: new google.maps.Point(17, 34),
                      scaledSize: new google.maps.Size(25, 25)
                  };
                  // Create a marker for each place.
                  var marker = new google.maps.Marker({
                      map: map,
                      icon: image,
                      title: place.name,
                      position: place.geometry.location
                  });

                  var content ="<div class='content'><h4 class='place_name'>"+place.name+"</h4><p class='location'>"
                      +"<b>Location:</b><br>" + place.formatted_address + "</p></div>";

                  if (place.price_level) {
                      content += "<p class='price_level'><b>Price Level:</b><br>"+ place.price_level.toString() +"</p>";
                  }
                 // Create a pop-up window on click.
                  google.maps.event.addListener(marker,'click', (function(marker,content,infowindow){
                      return function() {
                          infowindow.setContent(content);
                          infowindow.open(map,marker);
                      };
                  })(marker,content,infowindow));
              }
            });
           google.maps.event.addListener(map, 'bounds_changed', function() {
              var bounds = map.getBounds();
              searchBox.setBounds(bounds);
           });
*/
      }
      google.maps.event.addDomListener(window, 'load', initialize);
    </script>
  </head>
  <body>
    <input id="pac-input" class="controls" type="text" placeholder="Search Box">
    <div id="map-canvas"></div>
  </body>
</html>